config {
  type: "incremental",
  uniqueKey: ["account_id"],
  bigquery: {
    partitionBy: "registration_date"
  }
}

SELECT * 
from ${ref("dim_shopee_accounts_view")}
-- ${when(incremental(), `where registration_date > (select max(registration_date) from ${self()})`)}
WHERE account_id IS NOT NULL
${when(incremental(), `AND registration_date >= current_date()`)}